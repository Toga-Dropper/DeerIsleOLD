// Patrol 1 = 
ref array<vector> patrol_1  = {"8341.925781 5.169929 4791.609863", "8368.647461 8.270579 4793.337891", "8385.073242 11.341542 4815.075195", "8398.267578 13.014662 4822.376953", "8408.562500 14.043686 4823.235352", "8422.680664 14.968910 4819.858398", "8434.647461 15.645046 4817.752441", "8454.854492 15.389862 4814.713867", "8468.756836 15.098124 4812.204590", "8479.090820 14.725343 4809.563965", "8491.060547 13.422959 4807.928223", "8500.198242 12.218660 4809.334473", "8506.469727 11.541963 4813.652344", "8511.273438 10.453408 4818.877441"};

// Patrol 2 = 
ref array<vector> patrol_2  = {"5822.648438 10.426085 8328.343750", "5803.704590 10.656935 8338.311523", "5808.890625 10.666747 8350.976563", "5816.508301 10.581555 8346.791016", "5833.334473 9.682555 8334.385742", "5851.308105 8.389042 8348.364258", "5871.732422 7.368886 8363.985352", "5884.972656 7.039324 8373.335938"};

// Patrol 3 = 
ref array<vector> patrol_3  = {"4569.151367 8.289295 15316.166992", "4580.505859 8.200468 15295.703125", "4591.786621 7.669841 15288.988281", "4619.749512 7.610116 15321.447266", "4577.389160 8.173655 15344.454102", "4570.610840 6.751390 15376.863281", "4569.186035 6.753467 15382.925781", "4563.545898 6.723321 15383.832031"};

// Patrol 4 = 
ref array<vector> patrol_4  = {"2898.407227 3.927105 15763.397461", "2880.308105 5.228463 15762.486328", "2866.263672 5.879508 15760.859375", "2846.792969 5.773591 15755.819336", "2785.959961 3.858353 15741.115234", "2763.757080 4.476669 15742.465820", "2736.346924 5.278621 15742.894531", "2715.601074 5.258436 15752.178711", "2698.598633 5.410168 15763.417969", "2680.222412 5.008217 15775.001953", "2658.601807 3.792526 15788.494141", "2646.168701 2.958974 15795.785156"};

// Patrol 5 = 
ref array<vector> patrol_5  = {"2602.222412 3.254103 15202.509766", "2578.679199 5.920752 15169.096680", "2546.102783 9.295488 15153.032227", "2495.322754 6.880900 15180.420898", "2466.288818 7.008087 15178.834961", "2447.914063 7.216244 15174.834961", "2435.520752 5.764831 15185.467773", "2421.733398 5.051147 15190.268555", "2399.507324 5.263762 15173.686523", "2389.676758 6.550394 15150.454102", "2387.390625 6.846571 15123.593750", "2397.561768 6.166702 15097.348633", "2410.758789 3.419444 15062.883789", "2415.397949 5.833590 15043.652344", "2418.502441 7.937826 15014.774414", "2417.316895 8.509368 14978.077148", "2416.426270 7.388559 14962.324219", "2415.677490 5.638982 14949.056641", "2414.155029 5.612926 14922.241211", "2411.518799 5.644466 14903.758789", "2408.504150 5.781336 14882.815430", "2406.299805 5.040096 14867.443359", "2395.609131 3.381055 14854.696289", "2393.977295 3.821948 14867.043945"};

// Patrol 6 = 
ref array<vector> patrol_6  = {"1950.129150 5.760955 13722.976563", "1939.652222 4.919857 13704.864258", "1934.672974 3.950243 13685.271484", "1924.228516 2.635809 13653.918945", "1913.385620 2.763626 13621.613281", "1908.059082 2.815755 13603.399414", "1903.254761 2.764052 13590.336914", "1887.573120 2.559791 13567.536133", "1869.658936 3.424412 13541.631836", "1848.952881 4.057683 13511.611328", "1832.748169 3.891968 13488.105469", "1824.218872 2.786346 13462.254883", "1819.597290 2.395133 13446.989258", "1819.602539 2.223496 13405.758789", "1819.699829 3.007405 13365.167969", "1818.572021 4.081086 13346.368164", "1819.409912 5.481903 13315.750000", "1820.068604 5.475908 13291.883789", "1811.777710 2.497021 13244.822266", "1806.455078 2.842623 13216.986328"};

// Patrol 7 = 
ref array<vector> patrol_7  = {"1583.959717 5.832984 12060.982422", "1563.999878 5.777050 12079.116211", "1546.808228 5.048670 12090.590820", "1528.481445 5.120776 12101.846680", "1512.371094 5.371068 12110.451172", "1506.841675 5.574557 12114.814453", "1520.563232 5.421696 12129.828125", "1543.155273 3.724418 12157.249023", "1559.546021 3.579269 12174.445313", "1564.555176 2.882356 12199.822266", "1576.642822 3.431748 12233.677734", "1586.469482 3.277063 12251.219727", "1561.006592 4.122913 12242.423828", "1536.796875 3.664326 12233.277344", "1530.230957 3.264895 12216.502930"};

// Patrol 8 = 
ref array<vector> patrol_8  = {"1953.939209 6.180533 6625.745605", "1961.642700 6.317198 6631.236816", "1971.352295 5.982173 6638.555176", "1964.108765 6.832522 6645.020996", "1971.833374 6.734340 6651.588379"};

// Patrol 9 = 
ref array<vector> patrol_9  = {"6406.628906 43.157974 4968.004883", "6417.342285 43.084496 4975.839355", "6427.142578 42.304859 4986.414551", "6433.792969 41.637051 4993.100098", "6441.982422 40.152611 5000.366211", "6460.859375 35.976990 5011.971191", "6481.148438 32.224464 5023.820801", "6499.572754 29.471455 5038.536621", "6510.566406 28.821022 5048.090820", "6522.769531 28.493206 5056.151367", "6533.775391 27.914627 5061.659180"};

// Patrol 10 = 
ref array<vector> patrol_10 = {"7813.682129 20.935131 5050.920898", "7804.594238 22.260410 5024.680176", "7801.928223 23.255518 5014.738281", "7790.249512 25.616648 5005.230957", "7780.056641 27.740303 4997.285156", "7771.329590 29.625259 4987.173828", "7767.673828 31.615971 4972.738281", "7765.835449 33.219223 4958.692871", "7762.286621 35.067112 4940.573730", "7756.754395 36.697037 4926.866211"};

 // Patrol 11 =
ref array<vector> patrol_11 = {"591.568 22.3018 763.248", "657.714 30.4275 772.406", "650.889 37.7634 864.345", "592.248 57.6684 903.387", "607.048 31.6412 921.698", "575.976 30.3831 972.724", "535.294 29.591 996.144", "460.183 16.6023 956.739"};

 // Patrol 12 =
ref array<vector> patrol_12 = {"10114.544922 3.951303 2425.933838", "10114.791992 2.996581 2454.356934", "10108.256836 2.629413 2480.080811", "10106.404297 2.859638 2494.551025", "10095.301758 2.534970 2507.170166", "10083.389648 2.345577 2514.865967", "10070.458008 2.530449 2522.776367", "10059.861328 2.901664 2529.790771", "10044.234375 3.029709 2541.834961", "10019.218750 3.450140 2560.612793", "10012.200195 3.511390 2576.667236", "10006.946289 3.355651 2588.324219", "10005.485352 2.979714 2601.529053", "10004.102539 2.909280 2608.060303", "9988.392578 2.810150 2621.002197", "9977.206055 2.613836 2630.093018", "9980.965820 2.446887 2647.224121", "9991.350586 2.508704 2663.066406", "9992.926758 2.584664 2674.195801", "9993.344727 2.575820 2684.569092"};

 // Patrol 13 =
ref array<vector> patrol_13 = {"11369.666992 5.016849 2426.551758", "11372.925781 5.394916 2438.653564", "11376.137695 5.634555 2450.693115", "11379.887695 5.634396 2464.758545", "11388.239258 5.632881 2485.531006", "11391.795898 5.706165 2494.461914", "11396.118164 5.699912 2496.446045", "11405.881836 5.465689 2490.220215", "11420.352539 5.451920 2490.835449", "11441.207031 5.452369 2492.471436", "11458.622070 5.394578 2493.551758", "11468.619141 5.393432 2494.779541", "11470.060547 5.381868 2507.977783", "11453.159180 5.394448 2508.294678", "11430.533203 5.452513 2506.887939", "11413.387695 5.452405 2505.986328", "11408.270508 5.448608 2503.952637"};

 // Patrol 14 =
ref array<vector> patrol_14 = {"3123.826660 3.805014 5458.824707", "3115.570068 3.298156 5453.370117", "3108.260498 2.797172 5446.692871", "3104.829834 2.744270 5454.181152", "3103.038818 2.960140 5469.254883", "3098.208008 2.654679 5482.717773", "3091.488281 2.442083 5493.618652", "3083.161377 2.397683 5504.406738", "3076.145020 2.465977 5511.128906", "3080.868652 3.115506 5517.823242", "3085.113037 3.378807 5523.253906", "3081.647217 3.401976 5530.892090", "3074.800781 3.448827 5537.839355"};


// If you add another patrol array, add it to this list
ref array<array<vector>> patrol_list = {patrol_1, patrol_2, patrol_3, patrol_4, patrol_5, patrol_6, patrol_7, patrol_8, patrol_9, patrol_10, patrol_11, patrol_12, patrol_13, patrol_14};

// IMPORTANT: If you add an entry to the above list, pick the loadout for it by adding the loadout filename to this list
ref array<string> patrol_loadouts = {"SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json", "SoldierLoadout.json"};

// you may change these quantities
const int MIN_PER_PATROL = 1; // Min number of AI per patrol
const int MAX_PER_PATROL = 1; // Max number of AI per patrol
const int MAXR = 1500;				// This is the main spawn radius- how close a player needs to be to spawn them in.
const int MINR = 300;				// If a player is this close to the patrol start point, it is too close for them to spawn
const int DESPAWNR = 2000;			// If all players are this far away, they despawn.
const int RESPAWN_SECONDS = 3600;	// The amount of seconds before a new patrol will spawn, after they both die

class CustomPatrol : eAIDynamicPatrol {
	override void OnPatrolSpawn(eAIGroup patrol) {
		// Uncomment this line to change the faction of the patrol from Raiders (default)
		// eAIFactionGuards for example is a faction which only kills players who have their weapons out
		// patrol.SetFaction(new eAIFactionGuards());	
		// Uncomment this line to slow down or speed up the patrol (1.0 to 3.0)
		 patrol.SetSpeedLimit(0.9);
	}
	override void OnUnitSpawn(eAIBase unit) {
		// Uncomment this to give the AI unlimited magazines (new one is added on reload)
		unit.SetUnlimitedMags(true);	
		// You can also do anything you would do in the StartingEquipSetup() for players here	
		// These lines will add attachments the same way you would for a player. However, the AI must have the M4A1 class in the Loadout.json file already for it to work.
		//Weapon_Base weapon = Weapon_Base.Cast(unit.GetItemInHands());
		//weapon.GetInventory().CreateAttachment("M4_PlasticHndgrd");
		//weapon.GetInventory().CreateAttachment("M4_OEBttstck");
		//weapon.GetInventory().CreateAttachment("M4_CarryHandleOptic");
	}
};

autoptr array<autoptr eAIDynamicPatrol> patrols = {};

void InitDynamicPatrols() {
	for (int i = 0; i < patrol_list.Count(); i++) {
		string loadout = "SoldierLoadout.json"; // default
		if (i < patrol_loadouts.Count()) loadout = patrol_loadouts[i];
		int randomNumber = Math.RandomInt(MIN_PER_PATROL,MAX_PER_PATROL);		
		autoptr CustomPatrol pat = new CustomPatrol(patrol_list[i][0], patrol_list[i], loadout, randomNumber, MINR, MAXR, DESPAWNR, RESPAWN_SECONDS);
		patrols.Insert(pat);
		pat.UpdateTriggers();
	}
}

void SpawnSentry(vector pos, string loadout = "SoldierLoadout.json") {
	eAIGame game = MissionServer.Cast(GetGame().GetMission()).GetEAIGame();
	eAIBase ai = game.SpawnAI_Sentry(pos, loadout);
}

modded class CustomMission
{
	void StartingEquipSetup(PlayerBase player, bool clothesChosen)
	{
		m_eaiGame.GetGroupByLeader(player);
		super.StartingEquipSetup(player, clothesChosen);
	}
};